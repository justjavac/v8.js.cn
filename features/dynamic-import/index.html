<!doctype html><html lang=zh-CN><meta charset=utf-8><title>Dynamic import() Â· V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/_css/feature-support.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="Dynamic import() unlocks new capabilities compared to static import. This article compares the two and gives an overview of whatâ€™s new." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>æ˜¾ç¤ºå¯¼è‚®</a><nav><ul><li><a href=/ >ä¸»é¡µ</a><li><a href=/blog/ >åšå®¢</a><li><a href=/docs/ >æ–‡æ¡£</a><li><a href=/tools/ >å·¥å…·</a><li class=current><a href=/features title="JavaScript å’Œ WebAssembly çš„æ–°ç‰¹æ€§">JS/Wasm æ–°ç‰¹æ€§</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>Dynamic <code>import()</code></h1><p class=meta>å‘å¸ƒæ—¶é—´ <time datetime="2017-11-21 00:00:00" itemprop=datePublished>2017-11-21</time> Â· æ ‡ç­¾ï¼š <a href=/features/tags/ecmascript class=tag>ECMAScript</a> <a href=/features/tags/es2020 class=tag>ES2020</a></header><div itemprop=articleBody><p><a href=https://github.com/tc39/proposal-dynamic-import>Dynamic <code>import()</code></a> introduces a new function-like form of <code>import</code> that unlocks new capabilities compared to static <code>import</code>. This article compares the two and gives an overview of whatâ€™s new.<h2 id=static>Static <code>import</code> (recap) <a href=#static class=bookmark>#</a></h2><p>Chrome 61 shipped with support for the ES2015 <code>import</code> statement within <a href=/features/modules>modules</a>.<p>Consider the following module, located at <code>./utils.mjs</code>:<pre class=language-js><code class=language-js><span class="token comment">// Default export</span><br><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi from the default export!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// Named export `doStuff`</span><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function function-variable">doStuff</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Doing stuffâ€¦'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Hereâ€™s how to statically import and use the <code>./utils.mjs</code> module:<pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> module <span class="token keyword">from</span> <span class="token string">'./utils.mjs'</span><span class="token punctuation">;</span><br>  module<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// â†’ logs 'Hi from the default export!'</span><br>  module<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">// â†’ logs 'Doing stuffâ€¦'</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><div class=note><p><strong>Note:</strong> The previous example uses the <code>.mjs</code> extension to signal that itâ€™s a module rather than a regular script. On the web, file extensions donâ€™t really matter, as long as the files are served with the correct MIME type (e.g. <code>text/javascript</code> for JavaScript files) in the <code>Content-Type</code> HTTP header.<p>The <code>.mjs</code> extension is especially useful on other platforms such as <a href=https://nodejs.org/api/esm.html#esm_enabling>Node.js</a> and <a href=/docs/d8><code>d8</code></a>, where thereâ€™s no concept of MIME types or other mandatory hooks such as <code>type="module"</code> to determine whether something is a module or a regular script. Weâ€™re using the same extension here for consistency across platforms and to clearly make the distinction between modules and regular scripts.</div><p>This syntactic form for importing modules is a <em>static</em> declaration: it only accepts a string literal as the module specifier, and introduces bindings into the local scope via a pre-runtime â€œlinkingâ€ process. The static <code>import</code> syntax can only be used at the top-level of the file.<p>Static <code>import</code> enables important use cases such as static analysis, bundling tools, and tree-shaking.<p>In some cases, itâ€™s useful to:<ul><li>import a module on-demand (or conditionally)<li>compute the module specifier at runtime<li>import a module from within a regular script (as opposed to a module)</ul><p>None of those are possible with static <code>import</code>.<h2 id=dynamic>Dynamic <code>import()</code> ğŸ”¥ <a href=#dynamic class=bookmark>#</a></h2><p><a href=https://github.com/tc39/proposal-dynamic-import>Dynamic <code>import()</code></a> introduces a new function-like form of <code>import</code> that caters to those use cases. <code>import(moduleSpecifier)</code> returns a promise for the module namespace object of the requested module, which is created after fetching, instantiating, and evaluating all of the moduleâ€™s dependencies, as well as the module itself.<p>Hereâ€™s how to dynamically import and use the <code>./utils.mjs</code> module:<pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token keyword">const</span> moduleSpecifier <span class="token operator">=</span> <span class="token string">'./utils.mjs'</span><span class="token punctuation">;</span><br>  <span class="token keyword">import</span><span class="token punctuation">(</span>moduleSpecifier<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      module<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token comment">// â†’ logs 'Hi from the default export!'</span><br>      module<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token comment">// â†’ logs 'Doing stuffâ€¦'</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>Since <code>import()</code> returns a promise, itâ€™s possible to use <code>async</code>/<code>await</code> instead of the <code>then</code>-based callback style:<pre class=language-html><code class=language-html><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> moduleSpecifier <span class="token operator">=</span> <span class="token string">'./utils.mjs'</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>moduleSpecifier<span class="token punctuation">)</span><br>    module<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// â†’ logs 'Hi from the default export!'</span><br>    module<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// â†’ logs 'Doing stuffâ€¦'</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><div class=note><p><strong>Note:</strong> Although <code>import()</code> <em>looks</em> like a function call, it is specified as <em>syntax</em> that just happens to use parentheses (similar to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/super><code>super()</code></a>). That means that <code>import</code> doesnâ€™t inherit from <code>Function.prototype</code> so you cannot <code>call</code> or <code>apply</code> it, and things like <code>const importAlias = import</code> donâ€™t work â€” heck, <code>import</code> is not even an object! This doesnâ€™t really matter in practice, though.</div><p>Hereâ€™s an example of how dynamic <code>import()</code> enables lazy-loading modules upon navigation in a small single-page application:<pre class=language-html><code class=language-html><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>My library<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>books.html<span class="token punctuation">"</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Books<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movies.html<span class="token punctuation">"</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>movies<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Movies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>video-games.html<span class="token punctuation">"</span></span> <span class="token attr-name">data-entry-module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>video-games<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Video Games<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span>This is a placeholder for the content that will be loaded on-demand.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><br>  <span class="token keyword">const</span> main <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'main'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> links <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'nav > a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> link <span class="token keyword">of</span> links<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    link<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">try</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>link<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>entryModule<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string">.mjs</span><span class="token string template-punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">// The module exports a function named `loadPageInto`.</span><br>        module<span class="token punctuation">.</span><span class="token function">loadPageInto</span><span class="token punctuation">(</span>main<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        main<span class="token punctuation">.</span>textContent <span class="token operator">=</span> error<span class="token punctuation">.</span>message<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>The lazy-loading capabilities enabled by dynamic <code>import()</code> can be quite powerful when applied correctly. For demonstration purposes, <a href=https://twitter.com/addyosmani>Addy</a> modified <a href=https://hnpwa-vanilla.firebaseapp.com/ >an example Hacker News PWA</a> that statically imported all its dependencies, including comments, on first load. <a href=https://dynamic-import.firebaseapp.com/ >The updated version</a> uses dynamic <code>import()</code> to lazily load the comments, avoiding the load, parse, and compile cost until the user really needs them.<div class=note><p><strong>Note:</strong> If your app imports scripts from another domain (either statically or dynamically), the scripts need to be returned with valid CORS headers (such as <code>Access-Control-Allow-Origin: *</code>). This is because unlike regular scripts, module scripts (and their imports) are fetched with CORS.</div><h2 id=recommendations>Recommendations <a href=#recommendations class=bookmark>#</a></h2><p>Static <code>import</code> and dynamic <code>import()</code> are both useful. Each have their own, very distinct, use cases. Use static <code>import</code>s for initial paint dependencies, especially for above-the-fold content. In other cases, consider loading dependencies on-demand with dynamic <code>import()</code>.<h2 id=support>Dynamic <code>import()</code> support <a href=#support class=bookmark>#</a></h2><ul class=feature-support><li class="environment has-support"><span class="icon chrome">Chrome:</span> <span class=support>è‡ª <span class=version>63</span> ç‰ˆæœ¬å¼€å§‹æ”¯æŒ</span><li class="environment has-support"><span class="icon firefox">Firefox:</span> <span class=support>è‡ª <span class=version>67</span> ç‰ˆæœ¬å¼€å§‹æ”¯æŒ</span><li class="environment has-support"><span class="icon safari">Safari:</span> <span class=support>è‡ª <span class=version>11.1</span> ç‰ˆæœ¬å¼€å§‹æ”¯æŒ</span><li class="environment no-support"><span class="icon nodejs">Node.js:</span> <span class=support>ä¸æ”¯æŒ</span><li class="environment has-support has-link"><a href=https://babeljs.io/docs/en/babel-plugin-syntax-dynamic-import><span class="icon babel">Babel:</span> <span class=support>æ”¯æŒ</span></a></ul><div class=feature-support-info><a href=/features/support>å…³äºç‰¹æ€§æ”¯æŒåˆ—è¡¨</a></div></div><footer><div><picture><source srcset="/_img/avatars/mathias-bynens.avif, /_img/avatars/mathias-bynens@2x.avif 2x" type=image/avif><img alt="" height=96 loading=lazy src=/_img/avatars/mathias-bynens.jpg srcset="/_img/avatars/mathias-bynens@2x.jpg 2x" width=96></picture><p>ä½œè€…ï¼šMathias Bynens (<a href=https://twitter.com/mathias>@mathias</a>).</div><a href=https://twitter.com/v8js/status/932914724060254208 class=retweet>Retweet this article!</a></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/features/dynamic-import>åŸæ–‡</a> Â· <a href=/logo/ >å•†æ ‡</a> Â· <a href=/terms/ >æ¡æ¬¾</a> Â· <a href=https://policies.google.com/privacy/ >éšç§</a> Â· <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> Â· <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/features/dynamic-import.md rel=nofollow>åœ¨ GitHub ç¼–è¾‘æ­¤é¡µé¢</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>å¦‚æ— ç‰¹æ®Šè¯´æ˜ï¼Œæ­¤ V8 é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„æ‰€æœ‰ç¤ºä¾‹ä»£ç å‡åŸºäº <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> å‘å¸ƒã€‚é¡µé¢ä¸­çš„æ–‡å­—å†…å®¹é‡‡ç”¨ <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> è¿›è¡Œè®¸å¯ã€‚æ›´è¯¦ç»†çš„ä¿¡æ¯å¯ä»¥åœ¨ <a href=/terms#site-policies>ç«™ç‚¹ç­–ç•¥</a> ä¸­æ‰¾åˆ°ã€‚</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>