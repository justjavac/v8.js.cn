<!doctype html><html lang=zh-CN><meta charset=utf-8><title>V8 release v7.5 · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="V8 v7.5 features implicit caching of WebAssembly compilation artifacts, bulk memory operations, numeric separators in JavaScript, and much more!" name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li class=active><a href=/blog/ >博客</a><li><a href=/docs/ >文档</a><li><a href=/tools/ >工具</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>V8 release v7.5</h1><p class=meta>发布时间 <time datetime="2019-05-16 15:00:00" itemprop=datePublished title="2019-05-16 15:00:00">2019-05-16</time> · 标签： <a href=/blog/tags/release/ class=tag>release</a></header><div itemprop=articleBody><p>Every six weeks, we create a new branch of V8 as part of our <a href=/docs/release-process>release process</a>. Each version is branched from V8’s Git master immediately before a Chrome Beta milestone. Today we’re pleased to announce our newest branch, <a href=https://chromium.googlesource.com/v8/v8.git/+log/branch-heads/7.5>V8 version 7.5</a>, which is in beta until its release in coordination with Chrome 75 Stable in several weeks. V8 v7.5 is filled with all sorts of developer-facing goodies. This post provides a preview of some of the highlights in anticipation of the release.<h2 id=webassembly>WebAssembly <a href=#webassembly class=bookmark>#</a></h2><h3 id=implicit-caching>Implicit caching <a href=#implicit-caching class=bookmark>#</a></h3><p>We are planning to roll out implicit caching of WebAssembly compilation artifacts in Chrome 75. This means users that visit the same page a second time don’t need to compile the already-seen WebAssembly modules. Instead they are loaded from the cache. This works similarly to <a href=/blog/code-caching-for-devs>Chromium’s JavaScript code-cache</a>.<p>In case you want to use a similar feature in your V8 embedding, please take inspiration from Chromium’s implementation.<h3 id=bulk-memory-operations>Bulk memory operations <a href=#bulk-memory-operations class=bookmark>#</a></h3><p><a href=https://github.com/webassembly/bulk-memory-operations>The bulk memory proposal</a> adds new instructions to WebAssembly for updating large regions of memory or tables.<p><code>memory.copy</code> copies data from one region to another, even if the regions are overlapping (like C’s <code>memmove</code>). <code>memory.fill</code> fills a region with a given byte (like C’s <code>memset</code>). Similar to <code>memory.copy</code>, <code>table.copy</code> copies from one region of a table to another, even if the regions are overlapping.<pre class=language-wasm><code class=language-wasm><span class="token comment">;; Copy 500 bytes from source 1000 to destination 0.</span><br><span class="token punctuation">(</span><span class="token keyword">memory</span>.copy <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">;; Fill 1000 bytes starting at 100 with the value `123`.</span><br><span class="token punctuation">(</span><span class="token keyword">memory</span>.fill <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">123</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">;; Copy 10 table elements from source 5 to destination 15.</span><br><span class="token punctuation">(</span><span class="token keyword">table</span>.copy <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>The proposal also provides a way to copy a constant region into linear memory or a table. To do so, we first need to define a “passive” segment. Unlike “active” segments, these segments are not initialized during module instantiation. Instead they can be copied into a memory or table region using the <code>memory.init</code> and <code>table.init</code> instructions.<pre class=language-wasm><code class=language-wasm><span class="token comment">;; Define a passive data segment.</span><br><span class="token punctuation">(</span><span class="token keyword">data</span> <span class="token variable">$hello</span> passive <span class="token string">"Hello WebAssembly"</span><span class="token punctuation">)</span><br><br><span class="token comment">;; Copy "Hello" into memory at address 10.</span><br><span class="token punctuation">(</span><span class="token keyword">memory</span>.init <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">;; Copy "WebAssembly" into memory at address 1000.</span><br><span class="token punctuation">(</span><span class="token keyword">memory</span>.init <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">i32<span class="token punctuation">.</span>const</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id=numeric-separators>Numeric separators in JavaScript <a href=#numeric-separators class=bookmark>#</a></h2><p>Large numeric literals are difficult for the human eye to parse quickly, especially when there are lots of repeating digits:<pre class=language-js><code class=language-js><span class="token number">1000000000000</span><br>   <span class="token number">1019436871.42</span></code></pre><p>To improve readability, <a href=/features/numeric-separators>a new JavaScript language feature</a> enables underscores as separators in numeric literals. So, the above can now be rewritten to group the digits per thousand, for example:<pre class=language-js><code class=language-js><span class="token number">1_000_000_000_000</span><br>    <span class="token number">1_019_436_871.42</span></code></pre><p>Now it’s easier to tell that the first number is a trillion, and the second number is in the order of 1 billion.<p>For more examples and additional information about numeric separators, see <a href=/features/numeric-separators>our explainer</a>.<h2 id=performance>Performance <a href=#performance class=bookmark>#</a></h2><h3 id=script-streaming-directly-from-network>Script streaming directly from network <a href=#script-streaming-directly-from-network class=bookmark>#</a></h3><p>As of Chrome 75, V8 can stream scripts directly from network into the streaming parser, without waiting for the Chrome main thread.<p>While previous Chrome versions had streaming parsing and compilation, the script source data coming in from the network always had to make its way to the Chrome main thread first before being forwarded to the streamer, for historical reasons. This meant that often, the streaming parser would be waiting for data that has arrived from the network already, but hadn’t been forwarded to the streaming task yet because it was blocked by other things happening on the main thread (such as HTML parsing, layout, or other JavaScript execution).<figure><img alt="" height=638 loading=lazy src=/_img/v8-release-75/before.jpg srcset="/_img/v8-release-75/before@2x.jpg 2x" width=1133><figcaption>Stalled background parsing tasks in Chrome 74 and older</figcaption></figure><p>In Chrome 75, we connect the network “data pipe” directly to V8, allowing us to read network data directly during streaming parsing, skipping the dependency on the main thread.<figure><img alt="" height=638 loading=lazy src=/_img/v8-release-75/after.jpg srcset="/_img/v8-release-75/after@2x.jpg 2x" width=1133><figcaption>In Chrome 75+, background parsing tasks are no longer blocked by activity on the main thread.</figcaption></figure><p>This allows us to finish streaming compiles earlier, improving the loading time of pages using streaming compilation, as well as reducing the number of concurrent (but stalled) streaming parse tasks, which reduces memory consumption.<h2 id=v8-api>V8 API <a href=#v8-api class=bookmark>#</a></h2><p>Please use <code>git log branch-heads/7.4..branch-heads/7.5 include/v8.h</code> to get a list of the API changes.<p>Developers with an <a href=/docs/source-code#using-git>active V8 checkout</a> can use <code>git checkout -b 7.5 -t branch-heads/7.5</code> to experiment with the new features in V8 v7.5. Alternatively you can <a href=https://www.google.com/chrome/browser/beta.html>subscribe to Chrome’s Beta channel</a> and try the new features out yourself soon.</div><footer><div><picture><source srcset="/_img/avatars/dan-elphick.avif, /_img/avatars/dan-elphick@2x.avif 2x" type=image/avif><img alt="" height=96 loading=lazy src=/_img/avatars/dan-elphick.jpg srcset="/_img/avatars/dan-elphick@2x.jpg 2x" width=96></picture><p>作者：Dan Elphick, scourge of the deprecated.</div><a href=https://twitter.com/v8js/status/1129073370623086593 class=retweet>Retweet this article!</a></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/blog/v8-release-75>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/blog/v8-release-75.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>