<!doctype html><html lang=zh-CN><meta charset=utf-8><title>V8 release v5.1 · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="V8 v5.1 comes with performance improvements, reduced jank and memory consumption, and increased support for ECMAScript language features." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li class=active><a href=/blog/ >博客</a><li><a href=/docs/ >文档</a><li><a href=/tools/ >工具</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>V8 release v5.1</h1><p class=meta>发布时间 <time datetime="2016-04-23 13:33:37" itemprop=datePublished title="2016-04-23 13:33:37">2016-04-23</time> · 标签： <a href=/blog/tags/release/ class=tag>release</a></header><div itemprop=articleBody><p>The first step in the V8 <a href=/docs/release-process>release process</a> is a new branch from the Git master immediately before Chromium branches for a Chrome Beta milestone (roughly every six weeks). Our newest release branch is <a href=https://chromium.googlesource.com/v8/v8.git/+log/branch-heads/5.1>V8 v5.1</a>, which will remain in beta until we release a stable build in conjunction with Chrome 51 Stable. Here’s a highlight of the new developer-facing features in this version of V8.<h2 id=improved-ecmascript-support>Improved ECMAScript support <a href=#improved-ecmascript-support class=bookmark>#</a></h2><p>V8 v5.1 contains a number of changes towards compliance with the ES2017 draft spec.<h3 id=symbol.species><code>Symbol.species</code> <a href=#symbol.species class=bookmark>#</a></h3><p>Array methods like <code>Array.prototype.map</code> construct instances of the subclass as its output, with the option to customize this by changing <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/species><code>Symbol.species</code></a>. Analogous changes are made to other built-in classes.<h3 id=instanceof-customization><code>instanceof</code> customization <a href=#instanceof-customization class=bookmark>#</a></h3><p>Constructors can implement their own <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol#Other_symbols><code>Symbol.hasInstance</code></a> method, which overrides the default behavior.<h3 id=iterator-closing>Iterator closing <a href=#iterator-closing class=bookmark>#</a></h3><p>Iterators created as part of a <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of><code>for</code>-<code>of</code></a> loop (or other built-in iteration, such as the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator>spread</a> operator) are now checked for a close method which is called if the loop terminates early. This can be used for clean-up duty after the iteration has finished.<h3 id=regexp-subclassing-exec-method>RegExp subclassing <code>exec</code> method <a href=#regexp-subclassing-exec-method class=bookmark>#</a></h3><p>RegExp subclasses can overwrite the <code>exec</code> method to change just the core matching algorithm, with the guarantee that this is called by higher-level functions like <code>String.prototype.replace</code>.<h3 id=function-name-inference>Function name inference <a href=#function-name-inference class=bookmark>#</a></h3><p>Function names inferred for function expressions are now typically made available in the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name><code>name</code></a> property of functions, following the ES2015 formalization of these rules. This may change existing stack traces and provide different names from previous V8 versions. It also gives useful names to properties and methods with computed property names:<pre class=language-js><code class=language-js><span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">{</span><br>  <span class="token operator">...</span><br>  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><br>  <span class="token operator">...</span><br><span class="token punctuation">}</span><br><span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">;</span><br>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token comment">// → '[Symbol.iterator]'</span></code></pre><h3 id=array.prototype.values><code>Array.prototype.values</code> <a href=#array.prototype.values class=bookmark>#</a></h3><p>Analogous to other collection types, the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/values><code>values</code></a> method on <code>Array</code> returns an iterator over the contents of the array.<h2 id=performance-improvements>Performance improvements <a href=#performance-improvements class=bookmark>#</a></h2><p>V8 v5.1 also brings a few notable performance improvements to the following JavaScript features:<ul><li>Executing loops like <code>for</code>-<code>in</code><li><code>Object.assign</code><li>Promise and RegExp instantiation<li>Calling <code>Object.prototype.hasOwnProperty</code><li><code>Math.floor</code>, <code>Math.round</code>, and <code>Math.ceil</code><li><code>Array.prototype.push</code><li><code>Object.keys</code><li><code>Array.prototype.join</code> & <code>Array.prototype.toString</code><li>Flattening repeat strings e.g. <code>'.'.repeat(1000)</code></ul><h2 id=wasm>WebAssembly (Wasm) <a href=#wasm class=bookmark>#</a></h2><p>V8 v5.1 has a preliminary support for <a href=/blog/webassembly-experimental>WebAssembly</a>. You can enable it via the flag <code>--expose_wasm</code> in <code>d8</code>. Alternatively you can try out the <a href=https://webassembly.github.io/demo/ >Wasm demos</a> with Chrome 51 (Beta Channel).<h2 id=memory>Memory <a href=#memory class=bookmark>#</a></h2><p>V8 implemented more slices of <a href=/blog/orinoco>Orinoco</a>:<ul><li>Parallel young generation evacuation<li>Scalable remembered sets<li>Black allocation</ul><p>The impact is reduced jank and memory consumption in times of need.<h2 id=v8-api>V8 API <a href=#v8-api class=bookmark>#</a></h2><p>Please check out our <a href=https://bit.ly/v8-api-changes>summary of API changes</a>. This document gets regularly updated a few weeks after each major release.<p>Developers with an <a href=https://v8.dev/docs/source-code#using-git>active V8 checkout</a> can use <code>git checkout -b 5.1 -t branch-heads/5.1</code> to experiment with the new features in V8 v5.1. Alternatively you can <a href=https://www.google.com/chrome/browser/beta.html>subscribe to Chrome's Beta channel</a> and try the new features out yourself soon.</div><footer><div><p>作者：the V8 team.</div></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/blog/v8-release-51>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/blog/v8-release-51.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>