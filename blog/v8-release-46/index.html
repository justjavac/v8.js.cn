<!doctype html><html lang=zh-CN><meta charset=utf-8><title>V8 release v4.6 · V8</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><meta content="V8 v4.6 comes with reduced jank and support for new ES2015 language features." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li class=active><a href=/blog/ >博客</a><li><a href=/docs/ >文档</a><li><a href=/tools/ >工具</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>V8 release v4.6</h1><p class=meta>发布时间 <time datetime="2015-08-28 13:33:37" itemprop=datePublished title="2015-08-28 13:33:37">2015-08-28</time> · 标签： <a href=/blog/tags/release/ class=tag>release</a></header><div itemprop=articleBody><p>Roughly every six weeks, we create a new branch of V8 as part of our <a href=https://v8.dev/docs/release-process>release process</a>. Each version is branched from V8’s Git master immediately before Chrome branches for a Chrome Beta milestone. Today we’re pleased to announce our newest branch, <a href=https://chromium.googlesource.com/v8/v8.git/+log/branch-heads/4.6>V8 version 4.6</a>, which will be in beta until it is released in coordination with Chrome 46 Stable. V8 4.6 is filled with all sorts of developer-facing goodies, so we’d like to give you a preview of some of the highlights in anticipation of the release in several weeks.<h2 id=improved-ecmascript-2015-(es6)-support>Improved ECMAScript 2015 (ES6) support <a href=#improved-ecmascript-2015-(es6)-support class=bookmark>#</a></h2><p>V8 v4.6 adds support for several <a href=https://www.ecma-international.org/ecma-262/6.0/ >ECMAScript 2015 (ES6)</a> features.<h3 id=spread-operator>Spread operator <a href=#spread-operator class=bookmark>#</a></h3><p>The <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator>spread operator</a> makes it much more convenient to work with arrays. For example it makes imperative code obsolete when you simply want to merge arrays.<pre class=language-js><code class=language-js><span class="token comment">// Merging arrays</span><br><span class="token comment">// Code without spread operator</span><br><span class="token keyword">const</span> inner <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> merged <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>inner<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Code with spread operator</span><br><span class="token keyword">const</span> inner <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> merged <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">...</span>inner<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>Another good use of the spread operator to replace <code>apply</code>:<pre class=language-js><code class=language-js><span class="token comment">// Function parameters stored in an array</span><br><span class="token comment">// Code without spread operator</span><br><span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token keyword">const</span> argsInArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Hi '</span><span class="token punctuation">,</span> <span class="token string">'Spread '</span><span class="token punctuation">,</span> <span class="token string">'operator!'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token function">myFunction</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> argsInArray<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Code with spread operator</span><br><span class="token keyword">function</span> <span class="token function">myFunction</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">const</span> argsInArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Hi '</span><span class="token punctuation">,</span> <span class="token string">'Spread '</span><span class="token punctuation">,</span> <span class="token string">'operator!'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token operator">...</span>argsInArray<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id=new.target><code>new.target</code> <a href=#new.target class=bookmark>#</a></h3><p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new.target><code>new.target</code></a> is one of ES6's features designed to improve working with classes. Under the hood it’s actually an implicit parameter to every function. If a function is called with the keyword new, then the parameter holds a reference to the called function. If new is not used the parameter is undefined.<p>In practice, this means that you can use new.target to figure out whether a function was called normally or constructor-called via the new keyword.<pre class=language-js><code class=language-js><span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">.</span>target <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">throw</span> <span class="token string">'Try out calling it with new.'</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Works!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// Breaks:</span><br><span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Works:</span><br><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>When ES6 classes and inheritance are used, new.target inside the constructor of a super-class is bound to the derived constructor that was invoked with new. In particular, this gives super-classes access to the prototype of the derived class during construction.<h2 id=reduce-the-jank>Reduce the jank <a href=#reduce-the-jank class=bookmark>#</a></h2><p><a href=https://en.wiktionary.org/wiki/jank#Noun>Jank</a> can be a pain, especially when playing a game. Often, it's even worse when the game features multiple players. <a href=http://oortonline.gl/ >oortonline.gl</a> is a WebGL benchmark that tests the limits of current browsers by rendering a complex 3D scene with particle effects and modern shader rendering. The V8 team set off in a quest to push the limits of Chrome’s performance in these environments. We’re not done yet, but the fruits of our efforts are already paying off. Chrome 46 shows incredible advances in oortonline.gl performance which you can see yourself below.<p>Some of the optimizations include:<ul><li><a href="https://code.google.com/p/v8/issues/detail?id=3996">TypedArray performance improvements</a><ul><li>TypedArrays are heavily used in rendering engines such as Turbulenz (the engine behind oortonline.gl). For example, engines often create typed arrays (such as Float32Array) in JavaScript and pass them to WebGL after applying transformations.<li>The key point was optimizing the interaction between the embedder (Blink) and V8.</ul><li><a href="https://code.google.com/p/chromium/issues/detail?id=515795">Performance improvements when passing TypedArrays and other memory from V8 to Blink</a><ul><li>There’s no need to create additional handles (that are also tracked by V8) for typed arrays when they are passed to WebGL as part of a one-way communication.<li>On hitting external (Blink) allocated memory limits we now start an incremental garbage collection instead of a full one.</ul><li><a href=/blog/free-garbage-collection>Idle garbage collection scheduling</a><ul><li>Garbage collection operations are scheduled during idle times on the main thread which unblocks the compositor and results in smoother rendering.</ul><li><a href="https://code.google.com/p/chromium/issues/detail?id=507211">Concurrent sweeping enabled for the whole old generation of the garbage collected heap</a><ul><li>Freeing of unused memory chunks is performed on additional threads concurrent to the main thread which significantly reduces the main garbage collection pause time.</ul></ul><p>The good thing is that all changes related to oortonline.gl are general improvements that potentially affect all users of applications that make heavy use of WebGL.<h2 id=v8-api>V8 API <a href=#v8-api class=bookmark>#</a></h2><p>Please check out our <a href=https://docs.google.com/document/d/1g8JFi8T_oAE_7uAri7Njtig7fKaPDfotU6huOa1alds/edit>summary of API changes</a>. This document gets regularly updated a few weeks after each major release.<p>Developers with an <a href=https://v8.dev/docs/source-code#using-git>active V8 checkout</a> can use <code>git checkout -b 4.6 -t branch-heads/4.6</code> to experiment with the new features in V8 v4.6. Alternatively you can <a href=https://www.google.com/chrome/browser/beta.html>subscribe to Chrome's Beta channel</a> and try the new features out yourself soon.</div><footer><div><p>作者：the V8 team.</div></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/blog/v8-release-46>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/blog/v8-release-46.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>